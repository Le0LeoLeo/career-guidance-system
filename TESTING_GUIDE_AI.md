# AI 功能测试指南

## ✅ 当前状态

根据测试结果：
- ✅ **Edge Function 已部署并正常工作**
- ✅ **数据库连接正常**
- ✅ **代码修复已完成**

---

## 🧪 完整测试步骤

### 1. 在浏览器中测试

#### 步骤 1: 打开应用
```bash
# 启动开发服务器
npm run dev
# 或
python -m http.server 8000
```

然后在浏览器中打开：`http://localhost:8000`

#### 步骤 2: 登录账户
- 使用 Firebase 登录
- 或使用现有账户

#### 步骤 3: 设定目标大学和科系
1. 进入"设定目标"页面
2. 选择目标大学（例如：台湾大学）
3. 选择目标科系（例如：资讯工程学系）
4. 点击保存

#### 步骤 4: 测试 AI 功能
在 AI 聊天界面中，尝试以下问题：

**测试问题 1: 基本目标查询**
```
我的理想大学是什么？
```

**预期结果：**
- AI 应该回答你的目标大学名称（例如："你的理想大学是台湾大学"）
- 如果设定了科系，也应该提到科系

**测试问题 2: 目标科系查询**
```
我的目标科系是什么？
```

**预期结果：**
- AI 应该回答你的目标科系名称

**测试问题 3: 综合查询**
```
请告诉我关于我的目标的信息
```

**预期结果：**
- AI 应该综合回答目标大学和科系的信息

---

### 2. 使用测试脚本

运行自动化测试脚本：

```bash
node test-ai-functionality.js
```

这个脚本会测试：
- ✅ Edge Function 连接
- ✅ 数据库字段完整性
- ✅ AI 读取目标信息的能力

---

### 3. 检查数据库

如果 AI 无法正确回答，检查数据库：

```bash
node fix-database-field.js
```

这个脚本会：
- 检查 `target_university_name` 字段是否存在
- 检查数据完整性
- 显示当前记录的状态

---

## 🔍 故障排除

### 问题 1: AI 无法回答目标大学

**可能原因：**
- 目标大学信息未保存
- 数据库字段为空

**解决方法：**
1. 重新设定目标大学和科系
2. 刷新页面
3. 再次询问 AI

### 问题 2: AI 回答错误的目标

**可能原因：**
- 缓存问题
- 数据库更新延迟

**解决方法：**
1. 清除浏览器缓存
2. 重新登录
3. 重新设定目标

### 问题 3: Edge Function 返回错误

**可能原因：**
- 环境变量未设置
- API Key 错误

**解决方法：**
1. 检查 Supabase Dashboard 中的环境变量
2. 确认 `BAIDU_API_KEY` 已正确设置
3. 查看函数日志

---

## 📝 验证清单

完成以下检查项：

- [ ] Edge Function 已部署（测试脚本显示 ✅）
- [ ] 数据库连接正常（测试脚本显示 ✅）
- [ ] 已登录应用账户
- [ ] 已设定目标大学和科系
- [ ] AI 能正确回答目标大学问题
- [ ] AI 能正确回答目标科系问题
- [ ] 目标信息在数据库中正确保存

---

## 🎯 下一步

如果所有测试都通过：

1. ✅ **功能已就绪** - 可以正常使用
2. 📚 **继续开发** - 可以添加更多功能
3. 🚀 **准备部署** - 可以部署到生产环境

如果测试失败：

1. 🔍 **查看日志** - 检查浏览器控制台和 Supabase 函数日志
2. 🐛 **报告问题** - 记录具体的错误信息
3. 🔧 **修复问题** - 根据错误信息进行修复

---

## 💡 提示

- 每次修改代码后，记得刷新浏览器页面
- 如果修改了 Edge Function，需要重新部署
- 使用浏览器开发者工具（F12）查看网络请求和错误信息
- 检查 Supabase Dashboard 中的函数日志，了解服务器端错误

